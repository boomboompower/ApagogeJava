import org.apache.tools.ant.filters.ReplaceTokens

plugins {
    id 'com.github.johnrengelman.shadow' version '6.0.0'
    id 'java'
}

group 'wtf.boomy.apagoge'
version '1.0'

repositories {
    mavenCentral()
}

dependencies {
    compile 'com.google.code.gson:gson:2.2.4'

    testCompile group: 'junit', name: 'junit', version: '4.12'
}

task processSource(type: Sync) {
    from sourceSets.main.java

    inputs.property 'FINGERPRINT', System.getenv('SHA1Signature') ?: ""

    filter(ReplaceTokens, tokens:
            ["FINGERPRINT": (System.getenv('SHA1Signature') ?: "")]
    )
    into "$buildDir/src"
}

compileJava {
    source = processSource.outputs
}

jar {
    manifest.attributes(
            'Main-Class' : 'wtf.boomy.apagoge.example.ExampleStartup'
    )
}